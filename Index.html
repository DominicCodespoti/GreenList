<!DOCTYPE html>
<html>

<body>

  <head>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <style>
      .ui-helper-hidden-accessible {
        border: 0;
        clip: rect(0 0 0 0);
        height: 1px;
        margin: -1px;
        overflow: hidden;
        padding: 0;
        position: absolute;
        width: 1px;
      }
    </style>
  </head>

  <h1>Welcome to Green Grocer!</h1>

  <p>Please enter an item:</p>

  <div class="ui-widget">
    <label for="tags"></label>

    <input type="text" id="tags" name="addItem" placeholder="Please Enter Your Item (e.g Toothpaste)" size=30>
    <button onclick="addItem()" id="additembutton"></button>
  </div>
  <table id="table" border="1">

  </table>
  <br>
  <button onclick="window.location = window.location">Delete List</button>

  <script>

    let products = [
      {
        "item": "Toothbrush",
        "suggestion": "Bamboo toothbrush",
        "tips": "Using this means there is one less plastic toothbrush floating around in the ocean."
      },
      {
        "item": "Nappies",
        "suggestion": "Reusable cloth",
        "tips": "They contain no harmful chemicals or plastic and actually less smelly than disposable nappies!"
      },
      {
        "item": "Milk",
        "suggestion": "Glass bottle organic milk",
        "tips": "They can be returned and reused, helping to reduce waste going to landfill."
      },
      {
        "item": "Coffee Pods",
        "suggestion": "Ground coffee",
        "tps": "When mixed with soil, coffee grounds release a compound that helps balance the nitrogen in composts"
      },
      {
        "item": "Straws",
        "suggestion": "Paper or metal straws",
        "tips": "Paper straws are biodegradable and take less amount of time to decompose."
      },
      {
        "item": "Eggs",
        "suggestion": "Free range organic eggs",
        "tips": "A less stress chicken means more nutrients for you. It is better both for YOU and the ANIMAL. "
      },
      {
        "item": "Dishwashing Liquid",
        "suggestion": "Earth Choice brand",
        "tips": "Earth Choice products use 100% recycled and recyclable plastic in the packaging."
      },
      {
        "item": "Oranges",
        "suggestion": "Buy them loose without the mesh bag",
        "tips": "This saves an estimated three tonnes of plastic per week, equating to 156 tonnes a year."
      },
      {
        "item": "Shampoo and Conditioner",
        "suggestion": "Sukin brand",
        "tips": "They have no synthetic fragrances or colours or animal derivatives and are 100% vegan and 100% carbon neutral."
      },
      {
        "item": "Toilet Paper",
        "suggestion": "icare brand",
        "tips": "It is made using soft white recycled paper."
      },
      {
        "item": "Party Cups",
        "suggestion": "Globelet branded biodegradeable cups",
        "tips": "Compostable products require a specific setting in order to break down, biodegradable products break down naturally."
      },
      {
        "item": "Bin Bag",
        "suggestion": "BioBag bag liners",
        "tips": "Renewable, biodegradable, and compostable raw materials are used to make this."
      },
      {
        "item": "Cling Wrap",
        "suggestion": "Beezewax food wrap",
        "tips": "Beeswax wrappers are made from organic cotton, and are then coated in jojoba oil, tree resin, and beeswax."
      },
      {
        "item": "Disposable Cutlery",
        "suggestion": "Ever Eco Bamboo cutlery set",
        "tips": "Bamboo produces 40% more oxygen than trees, reducing CO2 in the air. This cutlery is reusable and completely biodegradable."
      }
    ];

    var itemArray = [];
    var i = 0;

    function createAutocompleteArray() {
      var productList = [];
      for (var i = 0; i < products.length; i++) {
        productList.push(products[i].item);
      }
      return productList;
    }

    $(function () {
      var availableTags = createAutocompleteArray();
      $("#tags").autocomplete({
        source: availableTags,
        messages: {
          noResults: '',
          results: function () { }
        }
      });
    });

    function tipAndAlternative(i) {
      var suggestion = searchItem(i).suggestion;
      var tip = searchItem(i).tips;
      var markup = '<tr id="tip' + i + '" ><td onclick=replaceString(' + i + ')>' + suggestion + '</td><td>' + tip + '</td><td><input type="button" onclick=deleteThing(' + i + ')></td></tr>';
      if ($('#tip' + i).length === 0) {
        $('#item' + i).after(markup);
      }
    }

    function deleteThing(i) {
      $('#tip' + i).find('td:eq(0)').remove();
      $('#tip' + i).find('td:eq(0)').remove();
      $('#tip' + i).find('td:eq(0)').remove();
      $('#tip' + i).remove();
    }

    function replaceString(i) {
      $('#item' + i).find('td:eq(0)').text(searchItem(i).suggestion);
      $('#tip' + i).find('td:eq(0)').remove();
      $('#tip' + i).find('td:eq(0)').remove();
      $('#tip' + i).find('td:eq(0)').remove();
      $('#tip' + i).remove();
      $('#item' + i).removeClass();
      $('#item' + i).addClass("greenborder");
    }

    function searchItemAuto() {
      var searchValue = document.getElementsByName("addItem")[0].value
      for (var i = 0; i < products.length; i++) {
        if (products[i].item == searchValue) {
          document.querySelector('#myDiv').innerHTML = products[i].suggestion;
          //return products[i].suggestion;
        }
      }
    };

    function searchItem(i) {
      var searchValue = $('#item' + i).find('td:eq(0)').html();
      for (var i = 0; i < products.length; i++) {
        if (products[i].item == searchValue) {
          return products[i];
        }
      }
    };

    function addItem() {
      var item = document.getElementById("tags").value;
      itemArray.push(item);
      var markup = '<tr id="item' + i + '"><td onclick=tipAndAlternative(' + i + ')>' + item + '</td><td><button onclick=$(this).parent().parent().remove()>X</button></td><td><input type ="checkbox"></td></tr>';
      $('#table').append(markup)
      if (searchItem(i)) {
        $('#item' + i).addClass("green");
      }
      i++;
    }

  </script>

</body>

</html>
